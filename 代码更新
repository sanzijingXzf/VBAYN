Sub 查找相同填充色单元格()
    Dim searchRange As Range
    Dim sampleCell As Range
    Dim cell As Range
    Dim fillColor As Long
    Dim foundCells As Range
    
    ' 用户输入单元格区域
    On Error Resume Next
    Set searchRange = Application.InputBox("请输入单元格区域 (例如 A1:A10)", "选择单元格区域", Type:=8)
    On Error GoTo 0
    
    ' 检查用户是否取消输入框
    If searchRange Is Nothing Then Exit Sub
    
    ' 用户选择示例单元格
    On Error Resume Next
    Set sampleCell = Application.InputBox("请选择示例单元格", "选择示例单元格", Type:=8)
    On Error GoTo 0
    
    ' 检查用户是否取消输入框
    If sampleCell Is Nothing Then Exit Sub
    
    ' 获取示例单元格的填充色
    fillColor = sampleCell.Interior.Color
    
    ' 查找与示例单元格填充色相同的单元格
    For Each cell In searchRange
        If cell.Interior.Color = fillColor Then
            If foundCells Is Nothing Then
                Set foundCells = cell
            Else
                Set foundCells = Union(foundCells, cell)
            End If
        End If
    Next cell
    
    ' 选中相同颜色的单元格
    If Not foundCells Is Nothing Then
        foundCells.Select
        MsgBox "已找到并选中填充色相同的单元格。", vbInformation
    Else
        MsgBox "在指定的区域中没有找到填充色相同的单元格。", vbExclamation
    End If
End Sub
